<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.bluexiii.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="IT技术类文章、笔记分享">
<meta property="og:type" content="website">
<meta property="og:title" content="BlueXIII&#39;s Blog">
<meta property="og:url" content="http://www.bluexiii.com/page/17/index.html">
<meta property="og:site_name" content="BlueXIII&#39;s Blog">
<meta property="og:description" content="IT技术类文章、笔记分享">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="BlueXIII">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.bluexiii.com/page/17/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>BlueXIII's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">BlueXIII's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">热爱技术,持续学习</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/%E5%B8%B8%E7%94%A8%E6%8E%A8%E6%B5%81%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/%E5%B8%B8%E7%94%A8%E6%8E%A8%E6%B5%81%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" class="post-title-link" itemprop="url">常用推流测试工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:04:17" itemprop="dateCreated datePublished" datetime="2021-01-05T14:04:17+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Android推流"><a href="#Android推流" class="headerlink" title="Android推流"></a>Android推流</h2><h3 id="RTSP-Camera"><a href="#RTSP-Camera" class="headerlink" title="RTSP Camera"></a>RTSP Camera</h3><p><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.miv.rtspcamera&amp;hl=zh">https://play.google.com/store/apps/details?id=com.miv.rtspcamera&amp;hl=zh</a></p>
<p>播流地址：  </p>
<ul>
<li>RTSP  rtsp://10.10.38.141:5554</li>
<li>HLS   <a target="_blank" rel="noopener" href="http://10.10.38.141:8080/playlist.m3u">http://10.10.38.141:8080/playlist.m3u</a></li>
</ul>
<h3 id="RTMP-Camera"><a href="#RTMP-Camera" class="headerlink" title="RTMP Camera"></a>RTMP Camera</h3><p><a target="_blank" rel="noopener" href="https://play.google.com/store/apps/details?id=com.miv.rtmpcamera&amp;hl=en_US">https://play.google.com/store/apps/details?id=com.miv.rtmpcamera&amp;hl=en_US</a></p>
<p>RTMP推流：<br>rtmp://10.30.22.242:1935/hls/mystream</p>
<blockquote>
<p>需要提前搭建nginx-with-rtmp</p>
</blockquote>
<h2 id="OBS推流"><a href="#OBS推流" class="headerlink" title="OBS推流"></a>OBS推流</h2><p><a target="_blank" rel="noopener" href="https://obsproject.com/">https://obsproject.com/</a></p>
<h2 id="ffmpeg推流"><a href="#ffmpeg推流" class="headerlink" title="ffmpeg推流"></a>ffmpeg推流</h2><h3 id="推视频文件"><a href="#推视频文件" class="headerlink" title="推视频文件"></a>推视频文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i &#x2F;tmp&#x2F;test.mp4 -f flv rtmp:&#x2F;&#x2F;10.30.22.242:1935&#x2F;hls&#x2F;mystream</span><br><span class="line">ffmpeg -i &#x2F;tmp&#x2F;test2.flv -f flv rtmp:&#x2F;&#x2F;10.30.22.242:1935&#x2F;hls&#x2F;mystream</span><br></pre></td></tr></table></figure>
<h3 id="推USB摄像头"><a href="#推USB摄像头" class="headerlink" title="推USB摄像头"></a>推USB摄像头</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Windows列出设备</span><br><span class="line">ffplay -f dshow -i video&#x3D;&quot;USB2.0 Camera&quot;</span><br><span class="line"></span><br><span class="line"># macOS列出设备</span><br><span class="line">ffmpeg -f avfoundation -list_devices true -i &quot;&quot;</span><br><span class="line"></span><br><span class="line"># 只推摄像头</span><br><span class="line">ffmpeg -f avfoundation -framerate 30 -video_size 1280x720 -i &quot;0&quot; -vcodec libx264 -acodec libfaac -f flv rtmp:&#x2F;&#x2F;10.30.22.242:1935&#x2F;hls&#x2F;mystream</span><br><span class="line"></span><br><span class="line"># 推摄像头+麦克风</span><br><span class="line">ffmpeg -f avfoundation -framerate 30 -video_size 1280x720 -i &quot;0:1&quot; -vcodec libx264 -preset ultrafast -acodec libmp3lame -ar 44100 -ac 1 -f flv rtmp:&#x2F;&#x2F;10.30.22.242:1935&#x2F;hls&#x2F;mystream</span><br></pre></td></tr></table></figure>
<h3 id="推桌面录屏"><a href="#推桌面录屏" class="headerlink" title="推桌面录屏"></a>推桌面录屏</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f avfoundation -pixel_format uyvy422 -i &quot;1&quot; -f flv rtmp:&#x2F;&#x2F;10.30.22.242:1935&#x2F;hls&#x2F;mystream</span><br><span class="line">ffmpeg -f avfoundation -i &quot;1&quot; -vcodec libx264 -preset ultrafast -acodec libfaac -f flv rtmp:&#x2F;&#x2F;10.30.22.242:1935&#x2F;hls&#x2F;mystream</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/SRS%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/SRS%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">SRS配置笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:04:05" itemprop="dateCreated datePublished" datetime="2021-01-05T14:04:05+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h2><ul>
<li><a target="_blank" rel="noopener" href="http://ossrs.net/srs.release/releases/">http://ossrs.net/srs.release/releases/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ossrs/srs">https://github.com/ossrs/srs</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ossrs/srs/wiki/v3_CN_Home">https://github.com/ossrs/srs/wiki/v3_CN_Home</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/ossrs/srs/wiki/v3_CN_Docs">https://github.com/ossrs/srs/wiki/v3_CN_Docs</a></li>
</ul>
<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://gitee.com/winlinvip/srs.oschina.git srs</span><br><span class="line"><span class="built_in">cd</span> srs/trunk </span><br><span class="line">git remote set-url origin https://github.com/ossrs/srs.git</span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line">./configure --osx</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">./objs/srs -c conf/srs.conf</span><br><span class="line">./objs/srs -c conf/hls.conf</span><br><span class="line">./objs/srs -c conf/http.flv.live.conf</span><br><span class="line">./objs/srs -c conf/dash.conf</span><br><span class="line"></span><br><span class="line">[2020-08-19 08:35:47.917][Trace][4124][388] RTMP listen at tcp://0.0.0.0:1935, fd=7</span><br><span class="line">[2020-08-19 08:35:47.917][Trace][4124][388] HTTP-Server listen at tcp://0.0.0.0:8080, fd=8</span><br><span class="line">[2020-08-19 08:35:47.929][Trace][4124][388] signal installed, reload=1, reopen=30, fast_quit=15, grace_quit=3</span><br><span class="line">[2020-08-19 08:35:47.929][Trace][4124][388] http: api mount /console to ./objs/nginx/html/console</span><br></pre></td></tr></table></figure>
<h2 id="模拟推流"><a href="#模拟推流" class="headerlink" title="模拟推流"></a>模拟推流</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>((;;)); <span class="keyword">do</span> \</span><br><span class="line">    ./objs/ffmpeg/bin/ffmpeg -re -i ./doc/source.200kbps.768x320.flv \</span><br><span class="line">    -vcodec copy -acodec copy \</span><br><span class="line">    -f flv -y rtmp://127.0.0.1/live/livestream; \</span><br><span class="line">    sleep 1; \</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<ul>
<li>RTMP流地址 rtmp://127.0.0.1:1935/live/livestream</li>
<li>HLS流地址  <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/live/livestream.m3u8">http://127.0.0.1:8080/live/livestream.m3u8</a></li>
<li>HTTP FLV  <a target="_blank" rel="noopener" href="http://127.0.0.1:8080/live/livestream.flv">http://127.0.0.1:8080/live/livestream.flv</a></li>
<li>DASH流地址 <a target="_blank" rel="noopener" href="http://192.168.1.170:8080/live/livestream.mpd">http://192.168.1.170:8080/live/livestream.mpd</a></li>
</ul>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><ul>
<li>versions    /api/v1/versions    获取服务器版本信息</li>
<li>summaries    /api/v1/summaries    获取服务器的摘要信息</li>
<li>rusages    /api/v1/rusages    获取服务器资源使用信息</li>
<li>self_proc_stats    /api/v1/self_proc_stats    获取服务器进程信息</li>
<li>system_proc_stats    /api/v1/system_proc_stats    获取服务器所有进程情况</li>
<li>meminfos    /api/v1/meminfos    获取服务器内存使用情况</li>
<li>authors    /api/v1/authors    获取作者、版权和License信息</li>
<li>features    /api/v1/features    获取系统支持的功能列表</li>
<li>requests    /api/v1/requests    获取请求的信息，即当前发起的请求的详细信息</li>
<li>vhosts    /api/v1/vhosts    获取服务器上的vhosts信息</li>
<li>streams    /api/v1/streams    获取服务器的streams信息</li>
<li>clients    /api/v1/clients    获取服务器的clients信息，默认获取前10个</li>
<li>configs    /api/v1/configs    CUID配置，RAW API</li>
</ul>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/feixiangsmile/article/details/105881467">使用SRS和Nginx配置HLS、RTMP方式视频直播</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dd3f58392aa0">MAC 搭建RTMP服务器nginx 和 srs</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/nginx-rtmp%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/nginx-rtmp%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">nginx-rtmp配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:03:53" itemprop="dateCreated datePublished" datetime="2021-01-05T14:03:53+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Windows预编译版下载地址"><a href="#Windows预编译版下载地址" class="headerlink" title="Windows预编译版下载地址"></a>Windows预编译版下载地址</h2><p><a target="_blank" rel="noopener" href="http://nginx-win.ecsds.eu/download/">http://nginx-win.ecsds.eu/download/</a><br><a target="_blank" rel="noopener" href="http://nginx-win.ecsds.eu/download/nginx%201.7.11.3%20Gryphon.zip">http://nginx-win.ecsds.eu/download/nginx%201.7.11.3%20Gryphon.zip</a></p>
<blockquote>
<p>直接安装即可，不做赘述</p>
</blockquote>
<h2 id="yamdi"><a href="#yamdi" class="headerlink" title="yamdi"></a>yamdi</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>yamdi用于为rtmp点播文件添加索引</p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a target="_blank" rel="noopener" href="http://yamdi.sourceforge.net/">http://yamdi.sourceforge.net/</a><br><a target="_blank" rel="noopener" href="https://github.com/ioppermann/yamdi/releases">https://github.com/ioppermann/yamdi/releases</a></p>
<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc yamdi.c -o yamdi -O2 -Wall</span><br><span class="line">cp yamdi &#x2F;usr&#x2F;local&#x2F;bin</span><br></pre></td></tr></table></figure>
<h2 id="nginx-rtmp"><a href="#nginx-rtmp" class="headerlink" title="nginx-rtmp"></a>nginx-rtmp</h2><ul>
<li><h3 id="源码下载"><a href="#源码下载" class="headerlink" title="源码下载"></a>源码下载</h3></li>
<li><a target="_blank" rel="noopener" href="https://github.com/arut/nginx-rtmp-module">nginx-rtmp-module</a></li>
<li><a target="_blank" rel="noopener" href="http://nginx.org/en/download.html">nginx</a></li>
<li><a target="_blank" rel="noopener" href="https://www.openssl.org/source/">openssl</a></li>
</ul>
<h3 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;opt&#x2F;nginx-rtmp --with-openssl&#x3D;..&#x2F;openssl-1.1.1g --add-module&#x3D;..&#x2F;nginx-rtmp-module-1.2.1 --with-debug</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log  logs/error.log debug;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rtmp &#123;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 1935;</span><br><span class="line"></span><br><span class="line">        application hls &#123;</span><br><span class="line">             live on;  <span class="comment">#启用rtmp直播</span></span><br><span class="line">                       <span class="comment">#地址为rtmp://[server]:[rtmp_port]/[app]/[stream]</span></span><br><span class="line">             hls on;   <span class="comment">#启用hls直播</span></span><br><span class="line">                       <span class="comment">#地址为http://[server]:[http_port]/[app]/[stream].m3u8</span></span><br><span class="line">                       <span class="comment">#需要配合下面http段设置使用</span></span><br><span class="line">             hls_path nginx-rtmp-module/tmp/app/;</span><br><span class="line">             hls_fragment 5s;</span><br><span class="line">             recorder rec &#123;  <span class="comment">#启用录制</span></span><br><span class="line">               record all manual;  <span class="comment">#手动控制录制启停</span></span><br><span class="line">               record_suffix _rec.flv;</span><br><span class="line">               record_path nginx-rtmp-module/tmp/rec/;  <span class="comment">#录制保存地址</span></span><br><span class="line">               record_unique on;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       application vod2&#123;  <span class="comment">#rtmp点播</span></span><br><span class="line">       		play nginx-rtmp-module/tmp/rec/;    </span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen      18080;</span><br><span class="line"></span><br><span class="line">        location /<span class="built_in">stat</span> &#123;  <span class="comment">#服务器状态</span></span><br><span class="line">            rtmp_stat all;</span><br><span class="line">            rtmp_stat_stylesheet stat.xsl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /stat.xsl &#123;</span><br><span class="line">            root nginx-rtmp-module/;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /control &#123; <span class="comment">#控制器</span></span><br><span class="line">            rtmp_control all;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">	    location /hls/ &#123;  <span class="comment">#hls直播地址</span></span><br><span class="line">           <span class="comment">#server hls fragments</span></span><br><span class="line">           types&#123;</span><br><span class="line">             application/vnd.apple.mpegurl m3u8;</span><br><span class="line">             video/mp2t ts;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="built_in">alias</span> nginx-rtmp-module/tmp/app/;</span><br><span class="line">           expires -1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /vod/&#123;  <span class="comment">#hls点播地址</span></span><br><span class="line">            <span class="built_in">alias</span> nginx-rtmp-module/tmp/rec/;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root nginx-rtmp-module/<span class="built_in">test</span>/www/;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意拷贝stat.xsl到相应目录下</p>
</blockquote>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="rtmp监控"><a href="#rtmp监控" class="headerlink" title="rtmp监控"></a>rtmp监控</h3><p><a target="_blank" rel="noopener" href="http://localhost:18080/stat">http://localhost:18080/stat</a></p>
<h3 id="rtmp推流"><a href="#rtmp推流" class="headerlink" title="rtmp推流"></a>rtmp推流</h3><p>地址：<br>rtmp://10.30.22.242:1935/hls/mystream</p>
<h3 id="rtmp直播"><a href="#rtmp直播" class="headerlink" title="rtmp直播"></a>rtmp直播</h3><p>rtmp://127.0.0.1:1935/hls/mystream</p>
<h3 id="hls直播"><a href="#hls直播" class="headerlink" title="hls直播"></a>hls直播</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1:18080/hls/mystream.m3u8">http://127.0.0.1:18080/hls/mystream.m3u8</a></p>
<h3 id="录制视频"><a href="#录制视频" class="headerlink" title="录制视频"></a>录制视频</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1:18080/control/record/start?app=hls&amp;name=mystream&amp;rec=rec">http://127.0.0.1:18080/control/record/start?app=hls&amp;name=mystream&amp;rec=rec</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1:18080/control/record/stop?app=hls&amp;name=mystream&amp;rec=rec">http://127.0.0.1:18080/control/record/stop?app=hls&amp;name=mystream&amp;rec=rec</a></p>
<h3 id="为rtmp点播文件添加索引"><a href="#为rtmp点播文件添加索引" class="headerlink" title="为rtmp点播文件添加索引"></a>为rtmp点播文件添加索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp&#x2F;rec</span><br><span class="line">yamdi -i mystream-1597303714_rec.flv -o mystream-1597303714_rec_idx.flv</span><br></pre></td></tr></table></figure>
<h3 id="rtmp点播"><a href="#rtmp点播" class="headerlink" title="rtmp点播"></a>rtmp点播</h3><p>rtmp://127.0.0.1:1935/vod2/mystream-1597303714_rec_idx.flv</p>
<h3 id="制作hls点播分片文件"><a href="#制作hls点播分片文件" class="headerlink" title="制作hls点播分片文件"></a>制作hls点播分片文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd nginx-rtmp&#x2F;nginx-rtmp-module&#x2F;tmp&#x2F;rec</span><br><span class="line"></span><br><span class="line">ffmpeg -i mystream-1597303714_rec.flv -acodec copy -bsf:a h264_mp4toannexb -g 105 -vcodec libx264 -vprofile baseline -bf 0 -bufsize 850k -bsf:v dump_extra -map 0 -f segment -segment_format mpegts -segment_list &quot;mystream-1597303714_rec.m3u8&quot; -segment_time 10 mystream-1597303714_rec-%d.ts</span><br><span class="line"></span><br><span class="line">ffmpeg -i mystream-1597303714_rec.flv -acodec copy -bsf:a aac_adtstoasc -g 105 -vcodec libx264 -vprofile baseline -bf 0 -bufsize 850k -bsf:v dump_extra -map 0 -f segment -segment_format mpegts -segment_list &quot;mystream-1597303714_rec.m3u8&quot; -segment_time 10 mystream-1597303714_rec-%d.ts</span><br></pre></td></tr></table></figure>
<h3 id="hls点播"><a href="#hls点播" class="headerlink" title="hls点播"></a>hls点播</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1:18080/vod/mystream-1597303714_rec.m3u8">http://127.0.0.1:18080/vod/mystream-1597303714_rec.m3u8</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/nginx-http-flv%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/nginx-http-flv%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">nginx-http-flv配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:03:41" itemprop="dateCreated datePublished" datetime="2021-01-05T14:03:41+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="github"><a href="#github" class="headerlink" title="github"></a>github</h2><p><a target="_blank" rel="noopener" href="https://github.com/winshining/nginx-http-flv-module/blob/master/README.CN.md">https://github.com/winshining/nginx-http-flv-module/blob/master/README.CN.md</a></p>
<h2 id="源码下载"><a href="#源码下载" class="headerlink" title="源码下载"></a>源码下载</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/winshining/nginx-http-flv-module">nginx-http-flv</a></li>
<li><a target="_blank" rel="noopener" href="http://nginx.org/en/download.html">nginx</a></li>
<li><a target="_blank" rel="noopener" href="https://www.openssl.org/source/">openssl</a></li>
</ul>
<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;opt&#x2F;nginx-flv --with-openssl&#x3D;..&#x2F;openssl-1.1.1g --add-module&#x3D;..&#x2F;nginx-http-flv-module-1.2.7 --with-debug</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1; #运行在Windows上时，设置为1，因为Windows不支持Unix domain socket</span><br><span class="line"></span><br><span class="line">error_log logs/error.log error;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  4096;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   /opt/nginx-flv/html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /live &#123;</span><br><span class="line">            flv_live on; #打开HTTP播放FLV直播流功能</span><br><span class="line">            chunked_transfer_encoding on; #支持&#x27;Transfer-Encoding: chunked&#x27;方式回复</span><br><span class="line"></span><br><span class="line">            add_header &#x27;Access-Control-Allow-Origin&#x27; &#x27;*&#x27;; #添加额外的HTTP头</span><br><span class="line">            add_header &#x27;Access-Control-Allow-Credentials&#x27; &#x27;true&#x27;; #添加额外的HTTP头</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /hls &#123;</span><br><span class="line">            types &#123;</span><br><span class="line">                application/vnd.apple.mpegurl m3u8;</span><br><span class="line">                video/mp2t ts;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            root /opt/nginx-flv/tmp;</span><br><span class="line">            add_header &#x27;Cache-Control&#x27; &#x27;no-cache&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /dash &#123;</span><br><span class="line">            root /opt/nginx-flv/tmp;</span><br><span class="line">            add_header &#x27;Cache-Control&#x27; &#x27;no-cache&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /stat &#123;</span><br><span class="line">            #推流播放和录制统计数据的配置</span><br><span class="line"></span><br><span class="line">            rtmp_stat all;</span><br><span class="line">            rtmp_stat_stylesheet stat.xsl;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /stat.xsl &#123;</span><br><span class="line">            root /opt/nginx-flv/html/rtmp; #指定stat.xsl的位置</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /control &#123;</span><br><span class="line">            rtmp_control all; #rtmp控制模块的配置</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rtmp_auto_push on;</span><br><span class="line">rtmp_auto_push_reconnect 1s;</span><br><span class="line">rtmp_socket_dir /opt/nginx-flv/tmp;</span><br><span class="line"></span><br><span class="line">rtmp &#123;</span><br><span class="line">    out_queue           4096;</span><br><span class="line">    out_cork            8;</span><br><span class="line">    max_streams         128;</span><br><span class="line">    timeout             15s;</span><br><span class="line">    drop_idle_publisher 15s;</span><br><span class="line"></span><br><span class="line">    log_interval 5s; #log模块在access.log中记录日志的间隔时间，对调试非常有用</span><br><span class="line">    log_size     1m; #log模块用来记录日志的缓冲区大小</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 1935;</span><br><span class="line">        # server_name www.test.*; #用于虚拟主机名后缀通配</span><br><span class="line"></span><br><span class="line">        application myapp &#123;</span><br><span class="line">            live on;</span><br><span class="line">            gop_cache on; #打开GOP缓存，减少首屏等待时间</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        application hls &#123;</span><br><span class="line">            gop_cache on;</span><br><span class="line">            live on;</span><br><span class="line">            hls on;</span><br><span class="line">            hls_path /opt/nginx-flv/tmp/hls;</span><br><span class="line"></span><br><span class="line">            hls_fragment 5s;</span><br><span class="line">            recorder rec &#123;  #启用录制</span><br><span class="line">                record all manual;  #手动控制录制启停</span><br><span class="line">                record_suffix _rec.flv;</span><br><span class="line">                record_path /opt/nginx-flv/tmp/record;  #录制保存地址</span><br><span class="line">                record_unique on;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        application dash &#123;</span><br><span class="line">            gop_cache on;</span><br><span class="line">            live on;</span><br><span class="line">            dash on;</span><br><span class="line">            dash_path /opt/nginx-flv/tmp/dash;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意拷贝stat.xsl到相应目录下</p>
</blockquote>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="rtmp监控"><a href="#rtmp监控" class="headerlink" title="rtmp监控"></a>rtmp监控</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1/stat">http://127.0.0.1/stat</a></p>
<h3 id="rtmp推流"><a href="#rtmp推流" class="headerlink" title="rtmp推流"></a>rtmp推流</h3><p>rtmp://10.30.22.242:1935/hls/mystream<br>rtmp://10.30.22.242:1935/dash/mystream<br>rtmp://10.30.22.242:1935/myapp/mystream</p>
<h3 id="rtmp直播"><a href="#rtmp直播" class="headerlink" title="rtmp直播"></a>rtmp直播</h3><p>rtmp://127.0.0.1:1935/hls/mystream<br>rtmp://127.0.0.1:1935/myapp/mystream</p>
<h3 id="hls直播"><a href="#hls直播" class="headerlink" title="hls直播"></a>hls直播</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1/hls/mystream.m3u8">http://127.0.0.1/hls/mystream.m3u8</a></p>
<h2 id="flv直播"><a href="#flv直播" class="headerlink" title="flv直播"></a>flv直播</h2><p><a target="_blank" rel="noopener" href="http://127.0.0.1/live?port=1935&amp;app=hls&amp;stream=mystream">http://127.0.0.1/live?port=1935&amp;app=hls&amp;stream=mystream</a></p>
<h3 id="dash直播"><a href="#dash直播" class="headerlink" title="dash直播"></a>dash直播</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1/dash/mystream.mpd">http://127.0.0.1/dash/mystream.mpd</a></p>
<h3 id="录制视频"><a href="#录制视频" class="headerlink" title="录制视频"></a>录制视频</h3><p><a target="_blank" rel="noopener" href="http://127.0.0.1/control/record/start?app=hls&amp;name=mystream&amp;rec=rec">http://127.0.0.1/control/record/start?app=hls&amp;name=mystream&amp;rec=rec</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1/control/record/stop?app=hls&amp;name=mystream&amp;rec=rec">http://127.0.0.1/control/record/stop?app=hls&amp;name=mystream&amp;rec=rec</a></p>
<h2 id="ffplay"><a href="#ffplay" class="headerlink" title="ffplay"></a>ffplay</h2><p>ffplay -i rtmp://127.0.0.1:1935/hls/mystream -fflags nobuffer -analyzeduration 1000000<br>ffplay “<a target="_blank" rel="noopener" href="http://127.0.0.1/live?port=1935&amp;app=hls&amp;stream=mystream&quot;">http://127.0.0.1/live?port=1935&amp;app=hls&amp;stream=mystream&quot;</a></p>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/winshining/article/details/74910586">https://blog.csdn.net/winshining/article/details/74910586</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/winshining/article/details/79492099">https://blog.csdn.net/winshining/article/details/79492099</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/winshining/article/details/81512775">https://blog.csdn.net/winshining/article/details/81512775</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/Livego%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/Livego%E9%85%8D%E7%BD%AE%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Livego配置笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:03:30" itemprop="dateCreated datePublished" datetime="2021-01-05T14:03:30+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/gwuhaolin/livego/blob/master/README_cn.md">https://github.com/gwuhaolin/livego/blob/master/README_cn.md</a></li>
</ul>
<h2 id="二进制下载"><a href="#二进制下载" class="headerlink" title="二进制下载"></a>二进制下载</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/gwuhaolin/livego/releases">https://github.com/gwuhaolin/livego/releases</a></li>
</ul>
<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;livego</span><br><span class="line"></span><br><span class="line">INFO[2020-08-18T16:55:13+08:00] HLS server enable....</span><br><span class="line">INFO[2020-08-18T16:55:13+08:00] HTTP-FLV listen On :7001</span><br><span class="line">INFO[2020-08-18T16:55:13+08:00] HTTP-API listen On :8090</span><br><span class="line">INFO[2020-08-18T16:55:13+08:00] RTMP Listen On :1935</span><br><span class="line">INFO[2020-08-18T16:55:13+08:00] HLS listen On :7002</span><br></pre></td></tr></table></figure>
<h2 id="获取channelkey"><a href="#获取channelkey" class="headerlink" title="获取channelkey"></a>获取channelkey</h2><p>访问 <a target="_blank" rel="noopener" href="http://localhost:8090/control/get?room=movie">http://localhost:8090/control/get?room=movie</a> 获取一个房间的 channelkey(channelkey用于推流，movie用于播放)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:8090/control/get?room=movie</span><br><span class="line">rfBd56ti2SMtYvSgD5xAV0YU99zampta7Z7S575KLkIZ9PYk</span><br></pre></td></tr></table></figure>
<h2 id="推流"><a href="#推流" class="headerlink" title="推流"></a>推流</h2><p>通过RTMP协议推送视频流到地址 rtmp://localhost:1935/{appname}/{channelkey} (appname默认是live)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -re -i test.mp4 -c copy -f flv rtmp://127.0.0.1:1935/live/rfBd56ti2SMtYvSgD5xAV0YU99zampta7Z7S575KLkIZ9PYk</span><br></pre></td></tr></table></figure>
<h2 id="播放"><a href="#播放" class="headerlink" title="播放"></a>播放</h2><ul>
<li>RTMP: rtmp://127.0.0.1:1935/live/movie</li>
<li>FLV:  <a target="_blank" rel="noopener" href="http://127.0.0.1:7001/live/movie.flv">http://127.0.0.1:7001/live/movie.flv</a></li>
<li>HLS:  <a target="_blank" rel="noopener" href="http://127.0.0.1:7002/live/movie.m3u8">http://127.0.0.1:7002/live/movie.m3u8</a></li>
</ul>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;livego  -h</span><br><span class="line">Usage of .&#x2F;livego:</span><br><span class="line">      --api_addr string       HTTP管理访问监听地址 (default &quot;:8090&quot;)</span><br><span class="line">      --config_file string    配置文件路径 (默认 &quot;livego.yaml&quot;)</span><br><span class="line">      --flv_dir string        输出的 flv 文件路径 flvDir&#x2F;APP&#x2F;KEY_TIME.flv (默认 &quot;tmp&quot;)</span><br><span class="line">      --gop_num int           gop 数量 (default 1)</span><br><span class="line">      --hls_addr string       HLS 服务监听地址 (默认 &quot;:7002&quot;)</span><br><span class="line">      --hls_keep_after_end    Maintains the HLS after the stream ends</span><br><span class="line">      --httpflv_addr string   HTTP-FLV server listen address (默认 &quot;:7001&quot;)</span><br><span class="line">      --level string          日志等级 (默认 &quot;info&quot;)</span><br><span class="line">      --read_timeout int      读超时时间 (默认 10)</span><br><span class="line">      --rtmp_addr string      RTMP 服务监听地址 (默认 &quot;:1935&quot;)</span><br><span class="line">      --write_timeout int     写超时时间 (默认 10)</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/ffmpeg&ffplay&ffprobe%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/ffmpeg&ffplay&ffprobe%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">ffmpeg&ffplay&ffprobe常用命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:03:21" itemprop="dateCreated datePublished" datetime="2021-01-05T14:03:21+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h2><ul>
<li><a target="_blank" rel="noopener" href="https://ffmpeg.org/ffmpeg.html">ffmpeg官网</a></li>
</ul>
<h2 id="ffprobe"><a href="#ffprobe" class="headerlink" title="ffprobe"></a>ffprobe</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看媒体文件信息</span></span><br><span class="line">ffprobe test.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出文件的格式信息</span></span><br><span class="line">ffprobe -show_format test.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以json格式输出每个流最详细的信息</span></span><br><span class="line">ffprobe -print_format json -show_streams test.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示帧信息</span></span><br><span class="line">ffprobe  -show_streams test.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看包信息</span></span><br><span class="line">ffprobe -show_packets test.mp4</span><br></pre></td></tr></table></figure>
<h2 id="ffplay"><a href="#ffplay" class="headerlink" title="ffplay"></a>ffplay</h2><h3 id="常用示例"><a href="#常用示例" class="headerlink" title="常用示例"></a>常用示例</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 播放音视频文件</span></span><br><span class="line">ffplay test.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环播放</span></span><br><span class="line">ffplay test.mp4 -loop 3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 播放音频流</span></span><br><span class="line">ffplay test.mp4 -ast 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 播放视频流</span></span><br><span class="line">ffplay test.mp4 -vst 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 播放rtmp流</span></span><br><span class="line">ffplay -i rtmp://127.0.0.1:1935/hls/mystream -fflags nobuffer -analyzeduration 1000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># 播放裸数据音频</span></span><br><span class="line">ffplay 原始文件(pcm文件) -f 格式 -channels 声道数 -ar 采样率</span><br><span class="line"><span class="comment"># 播放裸数据视频</span></span><br><span class="line">ffplay 原始格式(例如-f rawvideo) 格式(例如-pixel_format yuv420p) 宽高(例如-s 480*480) 原始文件(yuv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 播放裸数据RGB</span></span><br><span class="line">ffplay -f rawvideo -pixel_format rgb24 -s 480*480 texture.rgb</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h3 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通用参数</span></span><br><span class="line">-f fmt	指定格式(音频或视频格式)</span><br><span class="line">-i filename	指定输入文件名，在linux下当然也能指定:0.0(屏幕录制)或摄像头</span><br><span class="line">-y	覆盖已有文件</span><br><span class="line">-t duration	记录时长为</span><br><span class="line">-fs limit_size 设置文件大小上限</span><br><span class="line">-ss time_off	从指定的时间(s)开始， [-]hh:mm:ss[.xxx]的格式也支持</span><br><span class="line">-re 代表按照帧率发送,作为推流工具一定要加入参数,否则ffmpeg会按照最高速率向流媒体服务器不停发送数据</span><br><span class="line"></span><br><span class="line"><span class="comment"># 视频参数</span></span><br><span class="line">-b 指定比特率(bits/s)，似乎ffmpeg是自动VBR的，指定了就大概是平均比特率</span><br><span class="line">-bitexact    使用标准比特率</span><br><span class="line">-vb    指定视频比特率(bits/s)</span><br><span class="line">-vframes number    设置转换多少桢(frame)的视频</span><br><span class="line">-r rate    帧速率(fps) （可以改，确认非标准桢率会导致音画不同步，所以只能设定为15或者29.97）</span><br><span class="line">-s size    指定分辨率 (320x240)</span><br><span class="line">-aspect aspect    设置视频长宽比(4:3, 16:9 or 1.3333, 1.7777)</span><br><span class="line">-croptop size    设置顶部切除尺寸(<span class="keyword">in</span> pixels)</span><br><span class="line">-cropbottom size    设置底部切除尺寸(<span class="keyword">in</span> pixels)</span><br><span class="line">-cropleft size    设置左切除尺寸 (<span class="keyword">in</span> pixels)</span><br><span class="line">-cropright size    设置右切除尺寸 (<span class="keyword">in</span> pixels)</span><br><span class="line">-padtop size    设置顶部补齐尺寸(<span class="keyword">in</span> pixels)</span><br><span class="line">-padbottom size    底补齐(<span class="keyword">in</span> pixels)</span><br><span class="line">-padleft size    左补齐(<span class="keyword">in</span> pixels)</span><br><span class="line">-padright size    右补齐(<span class="keyword">in</span> pixels)</span><br><span class="line">-padcolor color    补齐带颜色(000000-FFFFFF)</span><br><span class="line">-vn    取消视频</span><br><span class="line">-vcodec codec    强制使用codec编解码方式(<span class="string">&#x27;copy&#x27;</span> to copy stream)</span><br><span class="line">-sameq    使用同样视频质量作为源（VBR）</span><br><span class="line">-pass n    选择处理遍数（1或者2）。两遍编码非常有用。第一遍生成统计信息，第二遍生成精确的请求的码率</span><br><span class="line">-passlogfile file    选择两遍的纪录文件名为file</span><br><span class="line">-newvideo    在现在的视频流后面加入新的视频流</span><br><span class="line"></span><br><span class="line"><span class="comment"># 高级视频选项</span></span><br><span class="line">-pix_fmt format    <span class="built_in">set</span> pixel format, <span class="string">&#x27;list&#x27;</span> as argument shows all the pixel formats supported</span><br><span class="line">-intra    仅适用帧内编码</span><br><span class="line">-qscale q    以&lt;数值&gt;质量为基础的VBR，取值0.01-255，约小质量越好</span><br><span class="line">-loop_input    设置输入流的循环数(目前只对图像有效)</span><br><span class="line">-loop_output    设置输出视频的循环数，比如输出gif时设为0表示无限循环</span><br><span class="line">-g int    设置图像组大小</span><br><span class="line">-cutoff int    设置截止频率</span><br><span class="line">-qmin int    设定最小质量，与-qmax（设定最大质量）共用，比如-qmin 10 -qmax 31</span><br><span class="line">-qmax int    设定最大质量</span><br><span class="line">-qdiff int    量化标度间最大偏差 (VBR)</span><br><span class="line">-bf int    使用frames B 帧，支持mpeg1,mpeg2,mpeg4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 音频参数</span></span><br><span class="line">-ab    设置比特率(单位：bit/s，也许老版是kb/s)前面-ac设为立体声时要以一半比特率来设置，比如192kbps的就设成96，转换 默认比特率都较小，要听到较高品质声音的话建议设到160kbps（80）以上。</span><br><span class="line">-aframes number    设置转换多少桢(frame)的音频</span><br><span class="line">-aq quality    设置音频质量 (指定编码)</span><br><span class="line">-ar rate    设置音频采样率 (单位：Hz)，PSP只认24000</span><br><span class="line">-ac channels    设置声道数，1就是单声道，2就是立体声，转换单声道的TVrip可以用1（节省一半容量），高品质的DVDrip就可以用2</span><br><span class="line">-an    取消音频</span><br><span class="line">-acodec codec    指定音频编码(<span class="string">&#x27;copy&#x27;</span> to copy stream)</span><br><span class="line">-vol volume    设置录制音量大小(默认为256) &lt;百分比&gt; ，某些DVDrip的AC3轨音量极小，转换时可以用这个提高音量，比如200就是原来的2倍</span><br><span class="line">-newaudio    在现在的音频流后面加入新的音频流</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字幕参数</span></span><br><span class="line">-sn    取消字幕</span><br><span class="line">-scodec codec    设置字幕编码(<span class="string">&#x27;copy&#x27;</span> to copy stream)</span><br><span class="line">-newsubtitle    在当前字幕后新增</span><br><span class="line">-slang code    设置字幕所用的ISO 639编码(3个字母)</span><br><span class="line">Audio/Video 抓取选项:</span><br><span class="line">-vc channel    设置视频捕获通道(只对DV1394)</span><br><span class="line">-tvstd standard    设置电视标准 NTSC PAL(SECAM)	</span><br></pre></td></tr></table></figure>

<h2 id="ffmpeg"><a href="#ffmpeg" class="headerlink" title="ffmpeg"></a>ffmpeg</h2><h3 id="参数格式"><a href="#参数格式" class="headerlink" title="参数格式"></a>参数格式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg &#123;1&#125; &#123;2&#125; -i &#123;3&#125; &#123;4&#125; &#123;5&#125;</span><br><span class="line">1. 全局参数</span><br><span class="line">2. 输入文件参数</span><br><span class="line">3. 输入文件</span><br><span class="line">4. 输出文件参数</span><br><span class="line">5. 输出文件</span><br><span class="line"></span><br><span class="line">ffmpeg \</span><br><span class="line">-y \ # 全局参数</span><br><span class="line">-c:a libfdk_aac -c:v libx264 \ # 输入文件参数</span><br><span class="line">-i input.mp4 \ # 输入文件</span><br><span class="line">-c:v libvpx-vp9 -c:a libvorbis \ # 输出文件参数</span><br><span class="line">output.webm # 输出文件</span><br></pre></td></tr></table></figure>
<h3 id="常用参数-1"><a href="#常用参数-1" class="headerlink" title="常用参数"></a>常用参数</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-c：指定编码器</span><br><span class="line">-c copy：直接复制，不经过重新编码（这样比较快）</span><br><span class="line">-c:v：指定视频编码器</span><br><span class="line">-c:a：指定音频编码器</span><br><span class="line">-i：指定输入文件</span><br><span class="line">-an：去除音频流</span><br><span class="line">-vn： 去除视频流</span><br><span class="line">-preset：指定输出的视频质量，会影响文件的生成速度，有以下几个可用的值 ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow。</span><br><span class="line">-y：不经过确认，输出时直接覆盖同名文件。</span><br></pre></td></tr></table></figure>
<h3 id="常用示例-1"><a href="#常用示例-1" class="headerlink" title="常用示例"></a>常用示例</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换编码格式</span></span><br><span class="line">ffmpeg -i input.mp4 -c:v libx264 output.mp4</span><br><span class="line">ffmpeg -i input.mp4 -c:v libx265 output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换容器格式</span></span><br><span class="line">ffmpeg -i input.mp4 -c copy output.webm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调整码率</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-i input.mp4 \</span><br><span class="line">-minrate 964K -maxrate 3856K -bufsize 2000K \</span><br><span class="line">output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 改变分辨率（transsizing）</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-i input.mp4 \</span><br><span class="line">-vf scale=480:-1 \</span><br><span class="line">output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取音频</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-i input.mp4 \</span><br><span class="line">-vn -c:a copy \</span><br><span class="line">output.aac</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加音轨</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-i input.aac -i input.mp4 \</span><br><span class="line">output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连续截图1秒钟</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-y \</span><br><span class="line">-i input.mp4 \</span><br><span class="line">-ss 00:01:24 -t 00:00:01 \</span><br><span class="line">output_%3d.jpg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定一帧截图</span></span><br><span class="line"><span class="comment"># -vframes 1指定只截取一帧，-q:v 2表示输出的图片质量</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-ss 00:01:24 \</span><br><span class="line">-i input.mp4 \</span><br><span class="line">-vframes 1 -q:v 2 \</span><br><span class="line">output.jpg</span><br><span class="line"></span><br><span class="line"><span class="comment"># 裁剪</span></span><br><span class="line">ffmpeg -ss 00:01:50 -i input.mp4 -t 10.5 -c copy output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为音频添加封面</span></span><br><span class="line"><span class="comment"># -loop 1参数表示图片无限循环，-shortest参数表示音频文件结束，输出视频就结束。</span></span><br><span class="line">ffmpeg \</span><br><span class="line">-loop 1 \</span><br><span class="line">-i cover.jpg -i input.mp3 \</span><br><span class="line">-c:v libx264 -c:a aac -b:a 192k -shortest \</span><br><span class="line">output.mp4</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="其它示例"><a href="#其它示例" class="headerlink" title="其它示例"></a>其它示例</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 列出ffmpeg支持的所有格式</span></span><br><span class="line">ffmpeg -formats</span><br><span class="line"></span><br><span class="line"><span class="comment"># 剪切一段媒体文件,将文件从50秒开始剪切20秒,输入到新文件,-ss是指定时间,-t是指定时长 提取一个视频中的音频文件</span></span><br><span class="line"></span><br><span class="line">ffmpeg -i input.mp4 -ss 00:00:50.0 -codec copy -t 20 output,mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取一个视频中的音频文件</span></span><br><span class="line">ffmpeg -i input.mp4 -vn -acodec copy output.m4a</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使一个视频中的音频静音</span></span><br><span class="line">ffmpeg -i input.mp4 -an -vcodec copy output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从MP4文件中导出H264裸流</span></span><br><span class="line">ffmpeg -i test.mp4 -an -vcodec copy -bsf:v h264_mp4toannexb output.h264</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用aac和h264文件生成mp4文件</span></span><br><span class="line">ffmpeg -i input.aac -i input.h264 -acodec copy -bsf:a aac_adtstoasc -vcodec copy -f mp4 output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对音频文件的编码做转换</span></span><br><span class="line">ffmpeg -i input.wav -acodec libfdk_aac output.aac</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从wav文件导出pcm裸数据</span></span><br><span class="line">ffmpeg -i input.wav -acodec pcm_s16le -f s16le output.pcm</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将mp4导出为gif,参数设置为宽度100,帧率10,只处理前五秒</span></span><br><span class="line">ffmpeg -i test.mp4 -vf sacle=100:-1 -t 5 -r 10 output.gif</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将视频画面生成图片,参数为每四秒截取一张,生成缩略图</span></span><br><span class="line">ffmpeg -i test.mp4 -r 0.25 frames_%04d.png</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将两路声音合并,例如添加背景音乐,输出时间是以较短的为准</span></span><br><span class="line">ffmpeg -i input.wav -i bgm.wav -filter_complex amix=inputs=2:deration=shortest output.wav</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 视频添加水印,视频宽度为100,水印宽度为20</span></span><br><span class="line">ffmpeg -i test.mp4 -i image.png -filter_complex <span class="string">&#x27;[0:v][1:v]overlay=100-20-10:10:1[out]&#x27;</span> -map <span class="string">&#x27;[out]&#x27;</span> output.mp4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将视频推送到流媒体服务器(-re表示实际速度)</span></span><br><span class="line">ffmpeg -re -i test.mp4 -acodec copy -vcodec copy -f flv rtmp://10.30.22.242:1935/hls/mystream</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将流媒体服务器的流dump到本地</span></span><br><span class="line">ffmpeg -i rtmp://10.30.22.242:1935/hls/mystream -acodec copy -vcodec copy -f flv output.flv</span><br></pre></td></tr></table></figure>

<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2020/01/ffmpeg.html">FFmpeg 视频处理入门教程</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/6844903550229676039">ffprobe,ffplay ffmpeg常用的命令行命令</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/146359917">FFmpeg常用技巧</a></li>
<li><a target="_blank" rel="noopener" href="https://www.longqi.cf/tools/2015/02/13/ffmpegcn/">ffmpeg中文手册</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202008/Anaconda%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202008/Anaconda%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">Anaconda常用操作</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:03:13" itemprop="dateCreated datePublished" datetime="2021-01-05T14:03:13+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --<span class="built_in">set</span> show_channel_urls yes</span><br><span class="line"></span><br><span class="line">conda config --show channels</span><br></pre></td></tr></table></figure>

<h2 id="查看版本等信息"><a href="#查看版本等信息" class="headerlink" title="查看版本等信息"></a>查看版本等信息</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda info</span><br><span class="line">conda -V/--version</span><br></pre></td></tr></table></figure>
<h2 id="环境查看"><a href="#环境查看" class="headerlink" title="环境查看"></a>环境查看</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda env list</span><br><span class="line">conda info -e</span><br></pre></td></tr></table></figure>
<h2 id="环境管理"><a href="#环境管理" class="headerlink" title="环境管理"></a>环境管理</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建新环境</span></span><br><span class="line">conda create --name newenv python=3.6</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制新环境</span></span><br><span class="line">conda create -n newenv --<span class="built_in">clone</span> base</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除环境</span></span><br><span class="line">conda remove --name newenv --all</span><br><span class="line"></span><br><span class="line"><span class="comment"># 激活环境</span></span><br><span class="line">conda activate newenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 退出环境</span></span><br><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>
<h2 id="环境导入导出"><a href="#环境导入导出" class="headerlink" title="环境导入导出"></a>环境导入导出</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导出</span></span><br><span class="line">conda env <span class="built_in">export</span> &gt; environment.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入</span></span><br><span class="line">conda env create -f .../environment.yaml</span><br></pre></td></tr></table></figure>
<h2 id="包管理"><a href="#包管理" class="headerlink" title="包管理"></a>包管理</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">conda list <span class="comment"># 查看已经安装的包</span></span><br><span class="line">conda update conda <span class="comment"># 升级conda自身</span></span><br><span class="line">conda search requests <span class="comment"># 查询某个包</span></span><br><span class="line">conda install requests <span class="comment"># 安装新包</span></span><br><span class="line">conda install -n <span class="built_in">test</span> requests <span class="comment"># 将包安装到指定环境</span></span><br><span class="line">conda update --all <span class="comment"># 更新所有包</span></span><br><span class="line">conda update requests <span class="comment"># 升级包</span></span><br><span class="line">conda remove requests <span class="comment"># 移除包</span></span><br><span class="line">conda remove -n <span class="built_in">test</span> requests <span class="comment"># 从指定环境中移除包</span></span><br></pre></td></tr></table></figure>
<h2 id="requirements-txt导入导出"><a href="#requirements-txt导入导出" class="headerlink" title="requirements.txt导入导出"></a>requirements.txt导入导出</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pip批量导出包含环境中所有组件的requirements.txt文件</span></span><br><span class="line">pip freeze &gt; requirements.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># pip批量安装requirements.txt文件中包含的组件依赖</span></span><br><span class="line">pip install -r requirements.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># conda批量导出包含环境中所有组件的requirements.txt文件</span></span><br><span class="line">conda list -e &gt; requirements.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># conda批量安装requirements.txt文件中包含的组件依赖</span></span><br><span class="line">conda install --yes --file requirements.txt</span><br></pre></td></tr></table></figure>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/">https://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/</a></li>
<li><a target="_blank" rel="noopener" href="http://lizhiqiang.me/conda/">http://lizhiqiang.me/conda/</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202005/%E7%A0%94%E5%8F%91%E8%A7%84%E7%BA%A6-TypeScript%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202005/%E7%A0%94%E5%8F%91%E8%A7%84%E7%BA%A6-TypeScript%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC/" class="post-title-link" itemprop="url">研发规约-TypeScript编码风格</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:02:56" itemprop="dateCreated datePublished" datetime="2021-01-05T14:02:56+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://acexking.github.io/2019/08/14/typescript/">https://acexking.github.io/2019/08/14/typescript/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/55701103">https://www.zhihu.com/question/55701103</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/microsoft/TypeScript/blob/master/doc/spec.md">https://github.com/microsoft/TypeScript/blob/master/doc/spec.md</a></li>
<li><a target="_blank" rel="noopener" href="https://scarletsky.github.io/2017/12/23/write-javascript-document-by-jsdoc/">https://scarletsky.github.io/2017/12/23/write-javascript-document-by-jsdoc/</a></li>
<li><a target="_blank" rel="noopener" href="https://jsdoc.app/about-getting-started.html">https://jsdoc.app/about-getting-started.html</a></li>
<li><a target="_blank" rel="noopener" href="https://hamednourhani.gitbooks.io/typescript-book/docs/tips/null.html">https://hamednourhani.gitbooks.io/typescript-book/docs/tips/null.html</a></li>
<li><a target="_blank" rel="noopener" href="https://basarat.gitbook.io/typescript/recap/null-undefined">https://basarat.gitbook.io/typescript/recap/null-undefined</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1125664">https://cloud.tencent.com/developer/article/1125664</a></li>
</ul>
<h2 id="tslint"><a href="#tslint" class="headerlink" title="tslint"></a>tslint</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/microsoft/typescript-tslint-plugin">https://github.com/microsoft/typescript-tslint-plugin</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/vvakame/typescript-project-sample/blob/master/tslint.json">https://github.com/vvakame/typescript-project-sample/blob/master/tslint.json</a></li>
</ul>
<h2 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h2><ul>
<li>类型名使用 PascalCase</li>
<li>接口名前不要加 I</li>
<li>枚举值使用 PascalCase</li>
<li>函数名使用 camelCase</li>
<li>属性和局部变量名使用 camelCase</li>
<li>使用UPPER_SNAKE_CASE来命名常量</li>
<li>私有属性名不要使用 _ 前缀</li>
<li>命名时尽可能地使用全名（而非缩写）</li>
</ul>
<h2 id="风格"><a href="#风格" class="headerlink" title="风格"></a>风格</h2><ul>
<li>使用单引号括起字符串</li>
<li>总是使用大括号括起循环体和条件体开大括号</li>
<li>总是放在其关联语句的同一行（大括号不换行）</li>
<li>圆括号内侧不留空格；在圆括号内的逗号、冒号和分号后空一格。</li>
<li>每个定义使用单独的语句。  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BAD: </span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>, y = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// GOOD:  </span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>; </span><br><span class="line"><span class="keyword">var</span> y = <span class="number">2</span>;</span><br></pre></td></tr></table></figure></li>
<li>const &gt; let &gt; var</li>
<li>当单行无法容下参数声明时, 在多行显示, 且参数必须对齐. 同理, 类成员, 数组成员接口成员也需要对齐</li>
<li>行末是否使用分号，不硬性规定</li>
<li>对于跨越多行的数组字面量, 对象字面量/import/export/type字面量/函数形参列表/函数调用实参等, 都应该尾随逗号  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> trailingWhitespace = &#123;</span><br><span class="line">foo: <span class="string">&#x27;string&#x27;</span>,</span><br><span class="line">bar: <span class="number">1</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2></li>
<li>使用<code>// </code>作为单行注释, 注释内容前面必须有空格</li>
<li>每个文件开头必须提供关于这个文件的注释.说明文件的内容, TODO, 更新日期, 权限等信息</li>
<li>使用/** …*/作为多行注释, 并使用JSDoc格式对代码进行文档化</li>
</ul>
<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><ul>
<li>只有一个参数时,可以省略括号  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arrowFunctiono = <span class="function"><span class="params">i</span> =&gt;</span> i </span><br></pre></td></tr></table></figure></li>
<li>如果可以尽量使用简写的返回  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shorthandReturno = <span class="function">() =&gt;</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li>
<li>别保存 this 的引用。优先使用箭头函数  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2></li>
<li>new 操作始终加上()</li>
<li>使用函数声明代替函数表达式  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BAD:</span></span><br><span class="line"><span class="keyword">const</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="comment">// GOOD:</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br></pre></td></tr></table></figure></li>
<li>不要使用 arguments。可以选择 rest 语法 … 替代。  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> args.join(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2></li>
<li>只有在必要时, 才添加引号  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> objo = &#123;</span><br><span class="line">foo: <span class="string">&#x27;string&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;foo bar&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>优先使用object spread 语法  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BAD:</span></span><br><span class="line"><span class="keyword">let</span> objectAssign = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1)</span><br><span class="line"><span class="comment">// GOOD:</span></span><br><span class="line"><span class="keyword">let</span> objectSpread = &#123; ...obj1 &#125;</span><br></pre></td></tr></table></figure>
<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2></li>
<li>始终显式设置成员的可见性, 这样可以提醒你慎重考虑属性的可见性, 避免将因为省略描述符而将私有成员暴露出去  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Membero</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="title">foo</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="comment">// do somthing</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="操作符-表达式"><a href="#操作符-表达式" class="headerlink" title="操作符/表达式"></a>操作符/表达式</h2></li>
<li>二元操作符中的字面量应该始终在变量的右边</li>
<li>不要比较boolean 字面量  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//BAD:</span></span><br><span class="line"><span class="keyword">let</span> baz = ok === <span class="literal">true</span> ? <span class="string">&#x27;foo&#x27;</span> : <span class="string">&#x27;baz&#x27;</span></span><br><span class="line"><span class="comment">// GOOD:</span></span><br><span class="line">baz = ok ? <span class="string">&#x27;foo&#x27;</span> : <span class="string">&#x27;baz&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>当使用if语句比较超过三个时, 考虑使用switch</li>
<li>优先使用字符串模板  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">temp = <span class="string">`print<span class="subst">$&#123;hello&#125;</span> <span class="subst">$&#123;world&#125;</span>`</span></span><br></pre></td></tr></table></figure>
<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2></li>
<li>导入默认导出, 最好匹配库默认的导出名  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BAD:</span></span><br><span class="line"><span class="keyword">import</span> IReact <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">// GOOD:</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li>为了减少打包体积, 避免引入整个模块, 而是按需引入需要的子模块. 典型的应用就是lodash  <figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BAD:</span></span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br><span class="line"><span class="comment">// GOOD:</span></span><br><span class="line"><span class="keyword">import</span> findIndex <span class="keyword">from</span> <span class="string">&#x27;lodash/findIndex&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2></li>
<li>除非类型/函数需要在多个组件中共享，否则不要导出(export)</li>
<li>在文件中，类型定义应该放在最前面</li>
<li>使用 undefined，不要使用 null </li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202005/%E7%A0%94%E5%8F%91%E8%A7%84%E7%BA%A6-ModelMapper%E5%AF%B9%E5%83%8F%E6%98%A0%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202005/%E7%A0%94%E5%8F%91%E8%A7%84%E7%BA%A6-ModelMapper%E5%AF%B9%E5%83%8F%E6%98%A0%E5%B0%84/" class="post-title-link" itemprop="url">研发规约-ModelMapper对像映射</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:02:50" itemprop="dateCreated datePublished" datetime="2021-01-05T14:02:50+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>项目中经常需要将Model和DTO互转，产生很多<code>getXXX/setXXX</code>的模板化代码。使用ModelMapper可以简化转换步骤。</p>
<h2 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h2><p><a target="_blank" rel="noopener" href="http://modelmapper.org/">http://modelmapper.org/</a></p>
<h2 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.modelmapper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>modelmapper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="对象示例"><a href="#对象示例" class="headerlink" title="对象示例"></a>对象示例</h2><p>源对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assume getters and setters on each class</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">  Customer customer;</span><br><span class="line">  Address billingAddress;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">  Name name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span> </span>&#123;</span><br><span class="line">  String firstName;</span><br><span class="line">  String lastName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">  String street;</span><br><span class="line">  String city;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>目标对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Assume getters and setters</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OrderDTO</span> </span>&#123;</span><br><span class="line">  String customerFirstName;</span><br><span class="line">  String customerLastName;</span><br><span class="line">  String billingStreet;</span><br><span class="line">  String billingCity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="自动转换"><a href="#自动转换" class="headerlink" title="自动转换"></a>自动转换</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ModelMapper modelMapper = <span class="keyword">new</span> ModelMapper();</span><br><span class="line">OrderDTO orderDTO = modelMapper.map(order, OrderDTO.class);</span><br></pre></td></tr></table></figure>
<h2 id="自定义转换"><a href="#自定义转换" class="headerlink" title="自定义转换"></a>自定义转换</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">modelMapper.typeMap(Order.class, OrderDTO.class).addMappings(mapper -&gt; &#123;</span><br><span class="line">  mapper.map(src -&gt; src.getBillingAddress().getStreet(),</span><br><span class="line">      Destination::setBillingStreet);</span><br><span class="line">  mapper.map(src -&gt; src.getBillingAddress().getCity(),</span><br><span class="line">      Destination::setBillingCity);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="转换配置"><a href="#转换配置" class="headerlink" title="转换配置"></a>转换配置</h2><p>ModelMapper有Standard、Loose、Strict 3种模式： </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelMapper.getConfiguration().setMatchingStrategy(MatchingStrategies.LOOSE);</span><br></pre></td></tr></table></figure>
<p>参考文档：<br><a target="_blank" rel="noopener" href="http://modelmapper.org/user-manual/configuration/#matching-strategies">http://modelmapper.org/user-manual/configuration/#matching-strategies</a></p>
<h2 id="转换校验"><a href="#转换校验" class="headerlink" title="转换校验"></a>转换校验</h2><p>assert手工校验：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assertEquals(order.getCustomer().getName().getFirstName(), orderDTO.getCustomerFirstName());</span><br></pre></td></tr></table></figure>
<p>ModelMapper自动校验：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">modelMapper.createTypeMap(Order.class, OrderDTO.class);</span><br><span class="line">modelMapper.addMappings(<span class="keyword">new</span> OrderMap());</span><br><span class="line">modelMapper.validate();</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://www.bluexiii.com/202005/%E7%A0%94%E5%8F%91%E8%A7%84%E7%BA%A6-Angular%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="BlueXIII">
      <meta itemprop="description" content="IT技术类文章、笔记分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BlueXIII's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/202005/%E7%A0%94%E5%8F%91%E8%A7%84%E7%BA%A6-Angular%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC/" class="post-title-link" itemprop="url">研发规约-Angular编码风格</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-01-05 14:02:40" itemprop="dateCreated datePublished" datetime="2021-01-05T14:02:40+08:00">2021-01-05</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://angular.cn/guide/styleguide">https://angular.cn/guide/styleguide</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/29784072">https://zhuanlan.zhihu.com/p/29784072</a></li>
<li><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/codelyzer">https://www.npmjs.com/package/codelyzer</a></li>
</ul>
<h2 id="单一职责"><a href="#单一职责" class="headerlink" title="单一职责"></a>单一职责</h2><ul>
<li>一个文件定义一样东西，比如一个组件、一个服务、一个管道、一个指令</li>
<li>每个文件最多不要超过400行</li>
<li>定义功能单一的函数</li>
<li>一个函数最多不要超过75行</li>
</ul>
<h2 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h2><ul>
<li>文件名采用<code>feature.type.**</code>，feature表示特性，type表示类型<ul>
<li>模块用 <code>.module.ts</code></li>
<li>路由模块用 <code>-routing.module.ts</code></li>
<li>组件用 <code>.component.ts|html|css</code></li>
<li>服务用 <code>.service.ts</code></li>
<li>管道用 <code>.pipe.ts</code></li>
<li>指令用 <code>.directive.ts</code></li>
<li>类型用 <code>.model.ts</code></li>
<li>数据用 <code>.data.ts</code></li>
</ul>
</li>
<li>用”-“来分割单词，比如<code>hero-list.component.ts</code></li>
<li>单元测试文件名保持和测试对象一致，并以<code>.spec.ts</code>结尾</li>
<li>端到端测试文件名保持和测试对象一致，并以<code>.e2e-spec.ts</code>结尾</li>
<li>类名用大写驼峰规则，并且保持跟文件名的一致<ul>
<li>模块：比如<code>app.module.ts</code>定义的类名为<code>AppModule</code></li>
<li>路由模块：比如<code>app-routing.module.ts</code>定义的类名为<code>AppRoutingModule</code></li>
<li>组件：比如<code>hero-list.component.ts</code>定义的类名为<code>HeroListComponent</code></li>
<li>服务：比如<code>logger.service.ts</code>定义的类名为<code>LoggerService</code></li>
<li>管道：比如<code>address.pipe.ts</code>定义的类名为<code>AddressPipe</code></li>
<li>指令：比如<code>highlight.directive.ts</code>定义的类名为<code>HighlightDirective</code></li>
<li>类型：按模块来划分，一个<code>.model.ts</code>定义多个类型</li>
<li>数据：比如<code>address-book.data.ts</code>定义的变量名为<code>addressBook</code></li>
</ul>
</li>
<li>脚本启动入口的文件名规定为main.ts，里面不包括任何业务逻辑，但要记得处理失败的情况</li>
<li>指令选择器的命名采用小写驼峰规则，比如<code>clickOutSide</code></li>
<li>组件选择器的命名采用分隔符“-”连接小写字母的形式，比如<code>hero-list</code></li>
</ul>
<h2 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h2><ul>
<li>类命名采用大写驼峰规则</li>
<li>常量定义用<code>const</code>，并且全部大写，如果有多个单词，用“_”连接，比如<code>HERO_URL</code></li>
<li>支持ES6的环境下，禁止使用<code>var</code>定义变量</li>
<li>变量命名尽量控制在3个单词以内，有常见缩写形式的单词可采用缩写形式</li>
<li>接口类型用大写驼峰规则，不建议以I为前缀，考虑用类代替接口</li>
<li>属性和方法名用小写驼峰，私有属性和方法不建议以“_”为前缀</li>
<li>建议用空一行的方式来区分第三方库的导入和项目本身文件的导入</li>
</ul>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><ul>
<li>好的项目结构的准则就是快速定位，快速识别，尽可能保持扁平，不要写冗余／重复代码</li>
<li>把所有项目代码放入src文件夹，为每个特性创建文件夹</li>
<li>第三方库放在src外的一个文件夹</li>
<li>每个组件、服务、管道、指令都独成一个文件</li>
<li>当组件有多个附属文件时（htm，css，ts，spec.ts），建议创建一个独立的文件夹</li>
</ul>
<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><ul>
<li>在<code>src/app</code>下创建根模块，建议命名为<code>app.module.ts</code></li>
<li>为每个特性创建一个模块，并且保持文件夹命名和模块命名一致</li>
<li>共享模块建议用<code>SharedModule</code>命名，放在<code>app/shared/shared.module.ts</code>中</li>
<li>在共享模块中定义复用的组件、指令和管道，避免在共享模块中定义服务</li>
<li>在共享模块中导入所有必需的模块，比如<code>CommonModule</code>和<code>FormsModule</code>，导出所有复用的模块、组件、指令、管道</li>
<li>考虑将只用一次的类放在核心特性模块中，并且仅在根模块中导入，建议写<code>guard.ts</code>来保证</li>
<li>核心特性模块建议用<code>CoreModule</code>命名，放在<code>app/core/core.module.ts</code>中</li>
<li>将单例服务放在核心特性模块中，比如<code>ExceptionService</code>和<code>LoggerService</code></li>
<li>在核心特性模块中导入所有必需的模块，比如<code>CommonModule</code>和<code>FormsModule</code>，导出所有定义的组件，服务等</li>
<li>将全局仅用一次的组件放在核心特性模块，然后只在<code>AppModule</code>中导入，比如<code>NavComponent</code>和<code>SpinnerComponent</code></li>
<li>独立的特性模块可以做成懒加载模块，避免在任何地方导入懒加载模块，不然模块就会直接加载</li>
</ul>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><ul>
<li>当模板/样式超过3行时，写成单独文件</li>
<li>删除无样式定义的样式文件</li>
<li>模板/样式的定义与组件命名保持一致</li>
<li>导入时使用相对路径</li>
<li>用装饰器<code>@Input</code>和<code>@Output</code>来修改输入输出数据，而不是使用元数据中的<code>inputs</code>和<code>outputs</code>属性</li>
<li>不推荐重命名输入输出数据</li>
<li>按照变量，构造器，生命周期函数，一般方法的顺序定义；一般方法按页面的功能模块放一起，被调用的方法写在后面；变量和方法均先公有后私有排列；</li>
<li>组件中只写跟视图相关的逻辑，把其他的业务逻辑放在服务中</li>
<li>将可复用的业务逻辑放在服务中</li>
<li>不推荐事件命名加上on前缀</li>
<li>将展示逻辑放在组件的类中，而不是在模板中</li>
</ul>
<h2 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h2><ul>
<li>当有跟模板无关的展示逻辑时，使用属性指令，比如<code>[highlight]</code>指令</li>
<li>推荐使用<code>@HostListener</code>和<code>@HostBinding</code>，而不是元数据的<code>host</code>属性</li>
</ul>
<h2 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h2><ul>
<li>保持单例服务的使用规则，服务用来在特性模块或者应用中共享数据和方法</li>
<li>跟函数一样，一个服务只有一个目的</li>
<li>把服务注入在最高层的组件／模块中，使得该单例服务能在子组件、子模块中共享</li>
<li>使用<code>@Injectable</code>装饰服务类，而不是<code>@Inject</code>装饰参数</li>
<li>跟数据相关的操作，比如<code>xhr</code>请求，本地储存等抽象成服务</li>
</ul>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><ul>
<li>需要生命周期钩子时，实现相关的接口，可有效防止错误</li>
</ul>
<h2 id="辅助工具"><a href="#辅助工具" class="headerlink" title="辅助工具"></a>辅助工具</h2><ul>
<li>用codelyzer来保持代码遵守该指南，当然你可以根据自己情况调整</li>
<li>使用IDE的代码片段工具来快速生成具有一致性的代码片段，比如给VS Code安装snippets</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/16/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/18/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">BlueXIII</p>
  <div class="site-description" itemprop="description">IT技术类文章、笔记分享</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">273</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xiiiblue" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xiiiblue" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/bluexiii" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;bluexiii" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">鲁ICP备18050487号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">BlueXIII</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
